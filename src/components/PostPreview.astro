---
import { formatReadingTime, getReadingTime } from '../utils/preview-helper';

export interface Props {
  blog: any;
}
const { blog } = Astro.props;

function formatDate(date) {
  return new Date(date).toUTCString().slice(5,16); // slice dd MMM yyyy
}

const readingTime = getReadingTime(blog.astro.source);
---

<style lang="scss">
.blog-post-wrapper {
  margin: 0 auto;
  max-width: min(60ch + 15vw, 830px);
}

.blog-post {
  color: var(--light-grey);
  padding: 35px 40px;
  margin-top: 55px;
  background-color: var(--item-bg-color);
  border-radius: 4px;
  box-shadow: var(--button-shadow);
}

.tag-wrapper {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
}

.tag {
  margin-right: 10px;
  margin-bottom: 10px;
  background-color: var(--dark-green);
  font-size: var(--desc-text-size);
  padding: 5px 10px;
  border-radius: 4px;
  white-space: nowrap;
  user-select: none;
}

.blog-post-preview {
  font-size: var(--code-text-size);
}

h2 {
  font-size: var(--h2-text-size);
  font-weight: 700;
  margin-top: 0;
  margin-bottom: 10px;
  line-height: 1.6;
  color: var(--light-blue);
}

.link, .description {
  font-size: var(--p-text-size);
}

p {
  margin: 15px 0;
}
.date {
  font-size: var(--desc-text-size);
  font-style: italic;
  display: block;
  margin-top: 0.25rem;
  margin-bottom: 0.5em;
}

.read-summary {
  font-size: var(--desc-text-size);
}

</style>

<article class="blog-post-wrapper">
  <div class="blog-post">
    <h2>{blog.title}</h2>
    <div class="tag-wrapper">
      {blog.tag.map(tag => <span class="tag">{tag}</span>)}
    </div>
    <span class="read-summary">{readingTime} min read {formatReadingTime(readingTime)}</span>
    <time class="date" datetime={blog.date}>{formatDate(blog.date)}</time>
    
    <p class="description">{blog.description}</p>
    <a class="link" href={blog.url} aria-label={`Read ${blog.title}`}>Read</a>
  </div>
</article>
